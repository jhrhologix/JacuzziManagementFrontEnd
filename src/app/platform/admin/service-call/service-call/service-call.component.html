<section class="client_list_main bg-white">
    <div class="row">
        <div class="col-md-6">
            <div class="search_bar">
                <div class="select_drop">
                    <select id="search" class="form-select" [(ngModel)]="selectedFilter" (change)="onChange()">
                        <option value="Name">{{ 'HEADER.NAME' | translate }}</option>
                        <option>{{ 'HEADER.Spa_Number' | translate }}</option>
                        <option>{{ 'HEADER.Service_call' | translate }}</option>
                        <option>{{ 'HEADER.Telephone' | translate }}</option>
                        <option>{{ 'HEADER.Client_Number' | translate }}</option>
                        <option>{{ 'HEADER.Address' | translate }}</option>
                    </select>
                </div>
                <div class="input-group mb-4 serch">
                    <input (keyup)="applyFilter($event)" placeholder="{{ 'HEADER.SEARCH' | translate }}" [(ngModel)]="searchQuery"
                        class="form-control bg-none border-0">
                    <button (click)="removefilter()" class="btn btn-outline-primary searchbuttonfilter">
                        <!-- {{ 'HEADER.Remove_Button' | translate }}  -->
                        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink"
                            width="30" height="30" x="0" y="0" viewBox="0 0 512 512"
                            style="enable-background:new 0 0 512 512" xml:space="preserve" class="">
                            <g>
                                <path
                                    d="M288.064 435.828a7.5 7.5 0 0 0-7.5 7.5v26.124c0 .119 0 .299-.259.448-.26.15-.415.058-.517-.001l-72.207-42.121a16.604 16.604 0 0 1-8.21-14.294V298.521h48.613a7.5 7.5 0 0 0 0-15h-52.912L25.076 106.135H454.86l-80.025 83.504c-2.866 2.991-2.765 7.738.226 10.604s7.738 2.765 10.604-.226l83.271-86.892a39.388 39.388 0 0 0 11-27.375V50.538c0-12.976-10.557-23.532-23.532-23.532H23.532C10.557 27.006 0 37.562 0 50.538v35.213c0 10.251 3.906 19.974 11 27.375l173.372 180.909v119.448c0 11.177 5.998 21.619 15.652 27.251l72.207 42.121c2.444 1.426 5.13 2.139 7.816 2.139 2.653 0 5.307-.696 7.729-2.087 4.877-2.801 7.788-7.831 7.788-13.455v-26.124a7.5 7.5 0 0 0-7.5-7.5zM15 50.538c0-4.705 3.828-8.532 8.532-8.532h432.871c4.705 0 8.532 3.827 8.532 8.532v35.213c0 1.831-.207 3.633-.598 5.384H15.598A24.686 24.686 0 0 1 15 85.751z"
                                    fill="#ffffff" opacity="1" data-original="#000000" class=""></path>
                                <path
                                    d="M392.274 219.393c-66.017 0-119.726 53.709-119.726 119.726s53.709 119.726 119.726 119.726S512 405.136 512 339.119s-53.708-119.726-119.726-119.726zm0 224.451c-57.746 0-104.726-46.98-104.726-104.726s46.98-104.726 104.726-104.726S497 281.373 497 339.119c0 57.745-46.979 104.725-104.726 104.725z"
                                    fill="#ffffff" opacity="1" data-original="#000000" class=""></path>
                                <path
                                    d="M445.674 285.719a7.497 7.497 0 0 0-10.606 0l-42.794 42.793-42.794-42.793a7.497 7.497 0 0 0-10.606 0 7.5 7.5 0 0 0 0 10.606l42.794 42.793-42.794 42.793a7.5 7.5 0 0 0 0 10.606c1.464 1.465 3.384 2.197 5.303 2.197s3.839-.732 5.303-2.197l42.794-42.793 42.794 42.793c1.464 1.465 3.384 2.197 5.303 2.197s3.839-.732 5.303-2.197a7.5 7.5 0 0 0 0-10.606l-42.794-42.793 42.794-42.793a7.497 7.497 0 0 0 0-10.606z"
                                    fill="#ffffff" opacity="1" data-original="#000000" class=""></path>
                            </g>
                        </svg>
                    </button>
                </div>
                
                <!-- <div id="loader" class="loader" *ngIf="isLoading">
                    <div class="load">
                    </div>
                  </div> -->

                <div class="table-responsive search_table" *ngIf="isSearchtable">
                    <table mat-table [dataSource]="searchclientlist" class="table">

                        <ng-container matColumnDef="clientNumber">
                            <th mat-header-cell *matHeaderCellDef>{{ 'HEADER.CLIENT_ID' | translate }}</th>
                            <td mat-cell *matCellDef="let element" (click)="selectClient(element, 'additionalValue')">
                                {{element.clientNumber}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="FirstName">
                            <th mat-header-cell *matHeaderCellDef> {{ 'HEADER.FIRST_NAME' | translate }} </th>
                            <td mat-cell *matCellDef="let element" (click)="selectClient(element, 'additionalValue')">
                                {{element.firstName}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="LastName">
                            <th mat-header-cell *matHeaderCellDef> {{ 'HEADER.LAST_NAME' | translate }} </th>
                            <td mat-cell *matCellDef="let element" (click)="selectClient(element, 'additionalValue')"> {{element.lastName}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="SpouseFirstName">
                            <th mat-header-cell *matHeaderCellDef>{{ 'HEADER.SpouseFirstName' | translate }}</th>
                            <td mat-cell *matCellDef="let element" (click)="selectClient(element, 'additionalValue')">
                                {{element.spouseFirstName}}
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="SpouseLastName">
                            <th mat-header-cell *matHeaderCellDef>{{ 'HEADER.SpouseLastName' | translate }}</th>
                            <td mat-cell *matCellDef="let element" (click)="selectClient(element, 'additionalValue')">
                                {{element.spouseLastName}}
                            </td>
                        </ng-container>
                        <tr mat-header-row *matHeaderRowDef="displayedSearchColumns1"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedSearchColumns1;"></tr>
                    </table>
                </div>

            </div>
        </div>
        <div class="col-md-6">
            <div class="my-2  d-flex align-items-end justify-content-end">
                <button (click)="clientpage()" type="submit" class="btn btn-outline-primary"> {{ 'SERVICE_CALL.Client_Info' | translate }} </button>
            </div>
        </div>
    </div>
    <form [formGroup]="serviceCallForm" autocomplete="off" (ngSubmit)="onSubmit()">
        <div class="row mt-3">


            <div class="col-md-4">
                <label for="nom" class="form-label"> {{ 'HEADER.Client_Number' | translate }} </label>
                <input type="test" formControlName="clientNumber" class="form-control" id="nom" placeholder="{{ 'HEADER.CLIENT_ID' | translate }}"
                    readonly>
            </div>
            <div class="col-md-4">
                <label for="nom" class="form-label"> {{ 'HEADER.FIRST_NAME' | translate }} </label>
                <input type="text" formControlName="firstName" class="form-control" id="nom" placeholder="{{ 'HEADER.FIRST_NAME' | translate }}" readonly>
            </div>
            <div class="col-md-4">
                <label for="prenom" class="form-label"> {{ 'HEADER.LAST_NAME' | translate }} </label>
                <input type="text" formControlName="lastName" class="form-control" id="prenom" placeholder="{{ 'HEADER.LAST_NAME' | translate }}"
                    readonly>
            </div>
        </div>
    </form>
    <div class="row mt-3">
        <div class="col-md-12">
            <h4> {{ 'SERVICE_CALL.ServiceList' | translate }} </h4>
            <div class="table-responsive">
                <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">

                    <!-- Client ID Column -->
                    <ng-container matColumnDef="Clientid">
                        <th mat-header-cell *matHeaderCellDef>Id </th>
                        <td mat-cell *matCellDef="let element"> {{element.serviceCallId}} </td>
                    </ng-container>

                    <!-- Appel Service Column -->
                    <ng-container matColumnDef="appelService">
                        <th mat-header-cell *matHeaderCellDef> {{ 'HEADER.Service_call' | translate }} </th>
                        <td mat-cell *matCellDef="let element"> {{element.serviceCallNumber}} </td>
                    </ng-container>

                    <!-- Date Rec Column -->
                    <ng-container matColumnDef="dateRec">
                        <th mat-header-cell *matHeaderCellDef> {{ 'HEADER.Reception_Date' | translate }} </th>
                        <td mat-cell *matCellDef="let element"> {{element.receptionDate | date:'yyyy-MM-dd'}} </td>
                    </ng-container>

                    <ng-container matColumnDef="datePlacement">
                        <th mat-header-cell *matHeaderCellDef>{{ 'HEADER.PLACEMENT' | translate }} </th>
                        <td mat-cell *matCellDef="let element"> {{element.servicePlacementDate | date:'yyyy-MM-dd'}}
                        </td>
                    </ng-container>

                    <!-- Probleme Column -->
                    <ng-container matColumnDef="probleme">
                        <th mat-header-cell *matHeaderCellDef> {{ 'SERVICE_CALL.Issue' | translate }} </th>
                        <td mat-cell *matCellDef="let element"> {{element.serviceIssue}} </td>
                    </ng-container>

                    <!-- Statut Column -->
                    <ng-container matColumnDef="statut">
                        <th mat-header-cell *matHeaderCellDef> {{ 'SERVICE_CALL.Status' | translate }} </th>
                        <td mat-cell *matCellDef="let element"> {{element.serviceCallStatus}} </td>
                    </ng-container>

                    <!-- Edit Column -->
                    <ng-container matColumnDef="edit">
                        <th mat-header-cell *matHeaderCellDef> {{ 'SERVICE_CALL.Edit' | translate }} </th>
                        <td mat-cell *matCellDef="let element">
                            <button (click)="editservicecall(element.serviceCallId)"
                                class="btn btn-outline-primary icons">
                                <mat-icon>edit</mat-icon>
                            </button>
                        </td>
                    </ng-container>

                    <!-- Delete Column -->
                    <ng-container matColumnDef="delete">
                        <th mat-header-cell *matHeaderCellDef> {{ 'HEADER.Delete' | translate }} </th>
                        <td mat-cell *matCellDef="let element">
                            <button (click)="openDeleteModal(element.serviceCallId)" class="btn btn-danger icons">
                                <mat-icon>delete</mat-icon>
                            </button>
                        </td>
                    </ng-container>
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>
                <mat-paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 25]" showFirstLastButtons></mat-paginator>
                 
            </div>
        </div>

    </div>
    <ng-container *ngIf="isselectedclient">
    <div class="row mt-3" >
        <div   class="col-12 gap-3 d-flex align-items-end justify-content-end">
            <button *ngIf="isselectedclient" type="submit" class="btn btn-outline-primary"  (click)="toggleNouelDiv()">{{ 'SERVICE_CALL.NewServiceCall' | translate }}</button>
        </div>
    </div>
</ng-container>
    <div *ngIf="isaddclient">
        <app-add-service-call [data]="sendData" (myOutput)="onSubmitChild($event)"></app-add-service-call>
    </div>
</section>
<div id="loader" class="loader" *ngIf="isLoading">
    <div class="load">
    </div>
  </div>
<div class="modal fade" id="secondModalnew" tabindex="-1" aria-labelledby="secondModalLabel" aria-hidden="false">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="secondModalLabel">{{ modalTitle }}</h5>
                <button type="button" id="closemodal" class="btn-close" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                {{ modalMessage }}
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"> {{'MODAL.Cancel' | translate }} </button>
                    <button type="button" class="btn btn-danger" (click)="confirmDelete()"> {{'HEADER.DELETE' | translate }} </button>
                </div>
            </div>

        </div>
    </div>
</div>